(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     33869,        976]
NotebookOptionsPosition[     31892,        902]
NotebookOutlinePosition[     32236,        917]
CellTagsIndexPosition[     32193,        914]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Calculate the cost function of a neural network with given architecture\
\>", "Title",
 CellChangeTimes->{{3.6662905917646275`*^9, 3.666290647241801*^9}, {
  3.666291453248902*^9, 3.6662914584932017`*^9}}],

Cell[CellGroupData[{

Cell["The network description", "Section",
 CellChangeTimes->{{3.666290719831953*^9, 3.6662907347568064`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"archit", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6662840534046545`*^9, 3.666284102570467*^9}, {
  3.666284510998828*^9, 3.666284513916995*^9}, {3.6663219532116437`*^9, 
  3.6663219568911257`*^9}, {3.666322637373359*^9, 3.666322638749914*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "3", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.6662841046755877`*^9, 3.666284514432024*^9, 
  3.6663207036810846`*^9, 3.6663219573873262`*^9, 3.6663220525366716`*^9, 
  3.6663226394531975`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<\[Theta]\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "<>", 
         RowBox[{"ToString", "[", "j", "]"}], "<>", 
         RowBox[{"ToString", "[", "k", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", " ", 
         RowBox[{"archit", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"k", ",", " ", "0", ",", " ", 
         RowBox[{"archit", "[", 
          RowBox[{"[", 
           RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", " ", 
       RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.666284109387857*^9, 3.6662841372464504`*^9}, {
   3.666284177399747*^9, 3.6662843513486967`*^9}, {3.666288289683956*^9, 
   3.6662883007135873`*^9}, 3.6662907509087305`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "<", 
    RowBox[{"Length", "[", "archit", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"Superscript", "[", 
      RowBox[{"\"\<\[Theta]\>\"", ",", " ", "i"}], "]"}], ",", "\"\< = \>\"", 
     ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"\[Theta]", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6662907740820556`*^9, 3.6662908858004456`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TemplateBox[{"\"\[Theta]\"","1"},
    "Superscript"], "\[InvisibleSpace]", "\<\" = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"\[Theta]110", "\[Theta]111", "\[Theta]112"},
       {"\[Theta]120", "\[Theta]121", "\[Theta]122"},
       {"\[Theta]130", "\[Theta]131", "\[Theta]132"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
   Superscript["\[Theta]", 1], " = ", 
   MatrixForm[{{$CellContext`\[Theta]110, $CellContext`\[Theta]111, \
$CellContext`\[Theta]112}, {$CellContext`\[Theta]120, \
$CellContext`\[Theta]121, $CellContext`\[Theta]122}, \
{$CellContext`\[Theta]130, $CellContext`\[Theta]131, \
$CellContext`\[Theta]132}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.666290832261383*^9, 3.6662908871085205`*^9}, 
   3.6663207059509993`*^9, 3.666321958901937*^9, 3.6663220533680067`*^9, 
   3.666322641054844*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TemplateBox[{"\"\[Theta]\"","2"},
    "Superscript"], "\[InvisibleSpace]", "\<\" = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"\[Theta]210", "\[Theta]211", "\[Theta]212", "\[Theta]213"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
   Superscript["\[Theta]", 2], " = ", 
   MatrixForm[{{$CellContext`\[Theta]210, $CellContext`\[Theta]211, \
$CellContext`\[Theta]212, $CellContext`\[Theta]213}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.666290832261383*^9, 3.6662908871085205`*^9}, 
   3.6663207059509993`*^9, 3.666321958901937*^9, 3.6663220533680067`*^9, 
   3.6663226410568447`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"A", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<a\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "1", ",", " ", 
        RowBox[{"archit", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Z", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<z\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "1", ",", " ", 
        RowBox[{"archit", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6662909105658617`*^9, 3.666291055416147*^9}, {
  3.666291150679596*^9, 3.666291150997614*^9}, {3.666291866424534*^9, 
  3.666291866507539*^9}, {3.6663207111711025`*^9, 3.6663207193223877`*^9}, {
  3.6663231761905017`*^9, 3.666323182182917*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a11", ",", "a12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a21", ",", "a22", ",", "a23"}], "}"}], ",", 
   RowBox[{"{", "a31", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.666291007485406*^9, 3.666291020185132*^9}, 
   3.666291056074185*^9, 3.666291151783659*^9, 3.6662918670105677`*^9, 
   3.666320720018668*^9, 3.666321959684252*^9, 3.6663220540132666`*^9, 
   3.666322641847163*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"z11", ",", "z12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z21", ",", "z22", ",", "z23"}], "}"}], ",", 
   RowBox[{"{", "z31", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.666291007485406*^9, 3.666291020185132*^9}, 
   3.666291056074185*^9, 3.666291151783659*^9, 3.6662918670105677`*^9, 
   3.666320720018668*^9, 3.666321959684252*^9, 3.6663220540132666`*^9, 
   3.666322641861169*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"h", "[", "x_", "]"}], "=", 
  FractionBox["1", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "x"}]]}]]}]], "Input",
 CellChangeTimes->{{3.666284545988829*^9, 3.6662845862261305`*^9}}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"1", "+", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "x"}]]}]]], "Output",
 CellChangeTimes->{3.6663207220885024`*^9, 3.6663219608837357`*^9, 
  3.666322054991661*^9, 3.666322642910591*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ruleA", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<a\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"h", "[", 
           RowBox[{
            RowBox[{"Z", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", 
         RowBox[{"archit", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", " ", 
       RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ruleZ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<z\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], ".", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", " ", 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", 
         RowBox[{"archit", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", " ", 
       RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.666285763870488*^9, 3.6662857838046284`*^9}, {
   3.6662863647198544`*^9, 3.66628641481472*^9}, {3.666286450172742*^9, 
   3.6662865872455826`*^9}, {3.666286629093976*^9, 3.6662866320011425`*^9}, 
   3.666286684564149*^9, {3.666286722315308*^9, 3.666286878005213*^9}, {
   3.6662869129682126`*^9, 3.666286970039477*^9}, {3.666287005387499*^9, 
   3.6662870955966587`*^9}, {3.666287137726068*^9, 3.6662871825716333`*^9}, {
   3.6662872220408907`*^9, 3.6662872383328223`*^9}, {3.6662874587524295`*^9, 
   3.666287700128236*^9}, {3.6662877732274165`*^9, 3.6662877797647905`*^9}, {
   3.6662878367290487`*^9, 3.6662878518549137`*^9}, {3.6662881033723*^9, 
   3.6662881590974874`*^9}, {3.666290171884612*^9, 3.6662903249963694`*^9}, {
   3.666291186619652*^9, 3.6662911993133774`*^9}, {3.6662916174822955`*^9, 
   3.6662916730584745`*^9}, 3.666292034966174*^9, {3.6663207501087947`*^9, 
   3.6663207594615636`*^9}, {3.6663220428477664`*^9, 3.666322043206911*^9}, {
   3.666323140232011*^9, 3.6663231403360524`*^9}, {3.6663231969368625`*^9, 
   3.666323204729003*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a11", "\[Rule]", "a11"}], ",", 
   RowBox[{"a12", "\[Rule]", "a12"}], ",", 
   RowBox[{"a21", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z21"}]]}]]}], ",", 
   RowBox[{"a22", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z22"}]]}]]}], ",", 
   RowBox[{"a23", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z23"}]]}]]}], ",", 
   RowBox[{"a31", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z31"}]]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.666291673985527*^9, 3.666291870054742*^9, 3.66629203611524*^9, 
   3.666320760104823*^9, 3.666321966592036*^9, {3.666322044238327*^9, 
   3.666322055865013*^9}, 3.6663226434488087`*^9, 3.6663231435533495`*^9, 
   3.6663232052922316`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"z21", "\[Rule]", 
    RowBox[{"\[Theta]110", "+", 
     RowBox[{"a11", " ", "\[Theta]111"}], "+", 
     RowBox[{"a12", " ", "\[Theta]112"}]}]}], ",", 
   RowBox[{"z22", "\[Rule]", 
    RowBox[{"\[Theta]120", "+", 
     RowBox[{"a11", " ", "\[Theta]121"}], "+", 
     RowBox[{"a12", " ", "\[Theta]122"}]}]}], ",", 
   RowBox[{"z23", "\[Rule]", 
    RowBox[{"\[Theta]130", "+", 
     RowBox[{"a11", " ", "\[Theta]131"}], "+", 
     RowBox[{"a12", " ", "\[Theta]132"}]}]}], ",", 
   RowBox[{"z31", "\[Rule]", 
    RowBox[{"\[Theta]210", "+", 
     RowBox[{"a21", " ", "\[Theta]211"}], "+", 
     RowBox[{"a22", " ", "\[Theta]212"}], "+", 
     RowBox[{"a23", " ", "\[Theta]213"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.666291673985527*^9, 3.666291870054742*^9, 3.66629203611524*^9, 
   3.666320760104823*^9, 3.666321966592036*^9, {3.666322044238327*^9, 
   3.666322055865013*^9}, 3.6663226434488087`*^9, 3.6663231435533495`*^9, 
   3.6663232053092375`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"J", " ", "[", " ", 
   RowBox[{"Y_", ",", " ", "\[Theta]_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{"[", "a", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], 
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "[", "archit", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"Y", "[", 
            RowBox[{"[", "a", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"Length", "[", "archit", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"Y", "[", 
          RowBox[{"[", "a", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "Y", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6662846018580246`*^9, 3.6662846160098343`*^9}, {
   3.6662846464095726`*^9, 3.666284671989036*^9}, {3.6662847109462643`*^9, 
   3.666284750665536*^9}, 3.666285190010665*^9, {3.6662852344242053`*^9, 
   3.6662852981698513`*^9}, {3.6662853442594876`*^9, 
   3.6662854565759115`*^9}, {3.666285527825987*^9, 3.6662855512033243`*^9}, {
   3.6662884796128197`*^9, 3.6662885504698725`*^9}, {3.6662900999264965`*^9, 
   3.6662901254439554`*^9}, {3.6662904702506776`*^9, 3.666290477553095*^9}, {
   3.666320847068869*^9, 3.666320908053446*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"J", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], ",", "\[Theta]"}], "]"}], "//.", 
  RowBox[{"Join", "[", 
   RowBox[{"ruleA", ",", "ruleZ"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6662885551451397`*^9, 3.666288593838353*^9}, {
   3.666290129785204*^9, 3.6662901299552135`*^9}, {3.6662903709779997`*^9, 
   3.6662903738451633`*^9}, {3.666290407141068*^9, 3.666290438858882*^9}, 
   3.6662904922119336`*^9, {3.66632091798845*^9, 3.666320924868222*^9}, 
   3.6663220629018483`*^9, {3.6663220953259153`*^9, 3.6663220972857046`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Log", "[", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Theta]210"}], "-", 
        FractionBox["\[Theta]211", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]110"}], "-", 
            RowBox[{"x1", " ", "\[Theta]111"}], "-", 
            RowBox[{"x2", " ", "\[Theta]112"}]}]]}]], "-", 
        FractionBox["\[Theta]212", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]120"}], "-", 
            RowBox[{"x1", " ", "\[Theta]121"}], "-", 
            RowBox[{"x2", " ", "\[Theta]122"}]}]]}]], "-", 
        FractionBox["\[Theta]213", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]130"}], "-", 
            RowBox[{"x1", " ", "\[Theta]131"}], "-", 
            RowBox[{"x2", " ", "\[Theta]132"}]}]]}]]}]]}]], "]"}]}], "-", 
  RowBox[{"Log", "[", 
   RowBox[{"1", "-", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Theta]210"}], "-", 
        FractionBox["\[Theta]211", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]110"}], "-", 
            RowBox[{"x1", " ", "\[Theta]111"}], "-", 
            RowBox[{"x2", " ", "\[Theta]112"}]}]]}]], "-", 
        FractionBox["\[Theta]212", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]120"}], "-", 
            RowBox[{"x1", " ", "\[Theta]121"}], "-", 
            RowBox[{"x2", " ", "\[Theta]122"}]}]]}]], "-", 
        FractionBox["\[Theta]213", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]130"}], "-", 
            RowBox[{"x1", " ", "\[Theta]131"}], "-", 
            RowBox[{"x2", " ", "\[Theta]132"}]}]]}]]}]]}]]}], 
   "]"}]}]], "Output",
 CellChangeTimes->{{3.6662885845418215`*^9, 3.666288594395385*^9}, {
   3.6662901083659787`*^9, 3.66629013041224*^9}, 3.6662903744481983`*^9, {
   3.6662904080061173`*^9, 3.6662904397919354`*^9}, {3.666290479312196*^9, 
   3.6662904928159685`*^9}, {3.6663209111777053`*^9, 3.6663209256285295`*^9}, 
   3.6663219704685984`*^9, 3.66632206364815*^9, 3.6663220978419294`*^9, 
   3.6663226455056367`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jtotal", "[", 
   RowBox[{"X_", ",", "Y_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"J", "[", 
      RowBox[{"Y", ",", "\[Theta]"}], "]"}], "//.", 
     RowBox[{"Join", "[", 
      RowBox[{"ruleA", ",", "ruleZ", ",", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"X", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
      "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "X", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6663229183976116`*^9, 3.6663229698583508`*^9}, {
  3.6663229998834505`*^9, 3.6663230165071497`*^9}, {3.666323068669171*^9, 
  3.6663231059361897`*^9}, {3.66632324683197*^9, 3.666323305208496*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Neural network with [2 3 1] architecture", "Section",
 CellChangeTimes->{{3.6663212482445426`*^9, 3.6663212877454615`*^9}, {
  3.666322632132247*^9, 3.666322633044615*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Theta]fix", " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "0.98"}], ",", 
        RowBox[{"-", "0.96"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.94"}], ",", 
        RowBox[{"-", "0.92"}], ",", 
        RowBox[{"-", "0.9"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.88"}], ",", 
        RowBox[{"-", "0.86"}], ",", 
        RowBox[{"-", "0.84"}]}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.82"}], ",", 
       RowBox[{"-", "0.8"}], ",", 
       RowBox[{"-", "0.78"}], ",", 
       RowBox[{"-", "0.76"}]}], "}"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6663211625890236`*^9, 3.6663212425852623`*^9}, {
  3.6663213114910307`*^9, 3.6663213400025215`*^9}, {3.666322432339731*^9, 
  3.66632243459564*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "0.98`"}], ",", 
       RowBox[{"-", "0.96`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.94`"}], ",", 
       RowBox[{"-", "0.92`"}], ",", 
       RowBox[{"-", "0.9`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.88`"}], ",", 
       RowBox[{"-", "0.86`"}], ",", 
       RowBox[{"-", "0.84`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.82`"}], ",", 
      RowBox[{"-", "0.8`"}], ",", 
      RowBox[{"-", "0.78`"}], ",", 
      RowBox[{"-", "0.76`"}]}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6663219234906664`*^9, 3.6663219396371727`*^9}, 
   3.666322102934982*^9, 3.6663224351628695`*^9, 3.666322648893002*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rule\[Theta]", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]fix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"k", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"\[Theta]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", " ", 
       RowBox[{"Length", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6663213456527977`*^9, 3.666321480164006*^9}, {
  3.666321532005898*^9, 3.666321541206606*^9}, {3.6663215802483397`*^9, 
  3.666321608911891*^9}, {3.666321774266529*^9, 3.6663218629082513`*^9}, {
  3.6663223813231716`*^9, 3.6663223935390944`*^9}, {3.666322448971434*^9, 
  3.6663225226371207`*^9}, {3.666322657935646*^9, 3.666322661086916*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Theta]110", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"\[Theta]111", "\[Rule]", 
    RowBox[{"-", "0.98`"}]}], ",", 
   RowBox[{"\[Theta]112", "\[Rule]", 
    RowBox[{"-", "0.96`"}]}], ",", 
   RowBox[{"\[Theta]120", "\[Rule]", 
    RowBox[{"-", "0.94`"}]}], ",", 
   RowBox[{"\[Theta]121", "\[Rule]", 
    RowBox[{"-", "0.92`"}]}], ",", 
   RowBox[{"\[Theta]122", "\[Rule]", 
    RowBox[{"-", "0.9`"}]}], ",", 
   RowBox[{"\[Theta]130", "\[Rule]", 
    RowBox[{"-", "0.88`"}]}], ",", 
   RowBox[{"\[Theta]131", "\[Rule]", 
    RowBox[{"-", "0.86`"}]}], ",", 
   RowBox[{"\[Theta]132", "\[Rule]", 
    RowBox[{"-", "0.84`"}]}], ",", 
   RowBox[{"\[Theta]210", "\[Rule]", 
    RowBox[{"-", "0.82`"}]}], ",", 
   RowBox[{"\[Theta]211", "\[Rule]", 
    RowBox[{"-", "0.8`"}]}], ",", 
   RowBox[{"\[Theta]212", "\[Rule]", 
    RowBox[{"-", "0.78`"}]}], ",", 
   RowBox[{"\[Theta]213", "\[Rule]", 
    RowBox[{"-", "0.76`"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.666322513790556*^9, 3.666322523393426*^9}, {
  3.666322650335583*^9, 3.6663226618792353`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Y", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"{", "0", "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"X", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", " ", "4"}], "}"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.666322747266647*^9, 3.666322763839325*^9}, {
  3.666323379816563*^9, 3.666323407369667*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6663227655890303`*^9, {3.666323387159522*^9, 3.6663234078488607`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6663227655890303`*^9, {3.666323387159522*^9, 3.6663234078628674`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{"X", ",", "\[Theta]"}], "]"}], "//.", 
   RowBox[{"Join", "[", 
    RowBox[{"ruleA", ",", "ruleZ"}], "]"}]}], "/.", "rule\[Theta]"}]], "Input",
 CellChangeTimes->{{3.6663227045504313`*^9, 3.6663227088871794`*^9}, 
   3.6663234238733177`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Log", "[", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"0.82`", "\[InvisibleSpace]", "+", 
        FractionBox["0.76`", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"0.88`", "\[InvisibleSpace]", "+", 
            RowBox[{"0.86`", " ", "x1"}], "+", 
            RowBox[{"0.84`", " ", "x2"}]}]]}]], "+", 
        FractionBox["0.78`", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"0.94`", "\[InvisibleSpace]", "+", 
            RowBox[{"0.92`", " ", "x1"}], "+", 
            RowBox[{"0.9`", " ", "x2"}]}]]}]], "+", 
        FractionBox["0.8`", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"1", "+", 
            RowBox[{"0.98`", " ", "x1"}], "+", 
            RowBox[{"0.96`", " ", "x2"}]}]]}]]}]]}]], "]"}]}], "-", 
  RowBox[{"Log", "[", 
   RowBox[{"1", "-", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"0.82`", "\[InvisibleSpace]", "+", 
        FractionBox["0.76`", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"0.88`", "\[InvisibleSpace]", "+", 
            RowBox[{"0.86`", " ", "x1"}], "+", 
            RowBox[{"0.84`", " ", "x2"}]}]]}]], "+", 
        FractionBox["0.78`", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"0.94`", "\[InvisibleSpace]", "+", 
            RowBox[{"0.92`", " ", "x1"}], "+", 
            RowBox[{"0.9`", " ", "x2"}]}]]}]], "+", 
        FractionBox["0.8`", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"1", "+", 
            RowBox[{"0.98`", " ", "x1"}], "+", 
            RowBox[{"0.96`", " ", "x2"}]}]]}]]}]]}]]}], "]"}]}]], "Output",
 CellChangeTimes->{3.6663227095904627`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Jtotal", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", " ", "4"}], "}"}]}], "}"}], ",", " ", "Y", ",", " ", 
   "\[Theta]"}], "]"}]], "Input",
 CellChangeTimes->{{3.666323314358184*^9, 3.6663233495203533`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   RowBox[{"Log", "[", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Theta]210"}], "-", 
        FractionBox["\[Theta]211", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]110"}], "-", 
            RowBox[{"a11", " ", "\[Theta]111"}], "-", 
            RowBox[{"a12", " ", "\[Theta]112"}]}]]}]], "-", 
        FractionBox["\[Theta]212", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]120"}], "-", 
            RowBox[{"a11", " ", "\[Theta]121"}], "-", 
            RowBox[{"a12", " ", "\[Theta]122"}]}]]}]], "-", 
        FractionBox["\[Theta]213", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]130"}], "-", 
            RowBox[{"a11", " ", "\[Theta]131"}], "-", 
            RowBox[{"a12", " ", "\[Theta]132"}]}]]}]]}]]}]], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[Theta]210"}], "-", 
         FractionBox["\[Theta]211", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[Theta]110"}], "-", 
             RowBox[{"a11", " ", "\[Theta]111"}], "-", 
             RowBox[{"a12", " ", "\[Theta]112"}]}]]}]], "-", 
         FractionBox["\[Theta]212", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[Theta]120"}], "-", 
             RowBox[{"a11", " ", "\[Theta]121"}], "-", 
             RowBox[{"a12", " ", "\[Theta]122"}]}]]}]], "-", 
         FractionBox["\[Theta]213", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[Theta]130"}], "-", 
             RowBox[{"a11", " ", "\[Theta]131"}], "-", 
             RowBox[{"a12", " ", "\[Theta]132"}]}]]}]]}]]}]]}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{3.6663233502066307`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1613, 717},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"7.0 for Microsoft Windows (64-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 215, 4, 83, "Title"],
Cell[CellGroupData[{
Cell[819, 30, 110, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[954, 35, 337, 6, 31, "Input"],
Cell[1294, 43, 251, 5, 30, "Output"]
}, Open  ]],
Cell[1560, 51, 1130, 28, 31, "Input"],
Cell[CellGroupData[{
Cell[2715, 83, 561, 15, 31, "Input"],
Cell[CellGroupData[{
Cell[3301, 102, 1399, 33, 50, "Print"],
Cell[4703, 137, 1168, 28, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5920, 171, 1454, 37, 52, "Input"],
Cell[7377, 210, 463, 11, 30, "Output"],
Cell[7843, 223, 463, 11, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8343, 239, 252, 7, 47, "Input"],
Cell[8598, 248, 245, 6, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8880, 259, 3305, 77, 52, "Input"],
Cell[12188, 338, 1035, 29, 47, "Output"],
Cell[13226, 369, 1015, 24, 30, "Output"]
}, Open  ]],
Cell[14256, 396, 1983, 50, 31, "Input"],
Cell[CellGroupData[{
Cell[16264, 450, 649, 14, 31, "Input"],
Cell[16916, 466, 2589, 64, 60, "Output"]
}, Open  ]],
Cell[19520, 533, 1264, 33, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20821, 571, 178, 2, 71, "Section"],
Cell[CellGroupData[{
Cell[21024, 577, 983, 30, 31, "Input"],
Cell[22010, 609, 899, 28, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22946, 642, 1732, 43, 31, "Input"],
Cell[24681, 687, 1126, 30, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25844, 722, 492, 14, 52, "Input"],
Cell[26339, 738, 216, 6, 30, "Output"],
Cell[26558, 746, 266, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26861, 759, 310, 8, 31, "Input"],
Cell[27174, 769, 1971, 50, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29182, 824, 346, 10, 31, "Input"],
Cell[29531, 836, 2321, 61, 60, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
