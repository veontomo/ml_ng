(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     61629,       1439]
NotebookOptionsPosition[     59899,       1377]
NotebookOutlinePosition[     60246,       1392]
CellTagsIndexPosition[     60203,       1389]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Calculate the cost function of a neural network with given architecture\
\>", "Title",
 CellChangeTimes->{{3.6662905917646275`*^9, 3.666290647241801*^9}, {
  3.666291453248902*^9, 3.6662914584932017`*^9}}],

Cell[CellGroupData[{

Cell["The network set up", "Section",
 CellChangeTimes->{{3.666290719831953*^9, 3.6662907347568064`*^9}, {
  3.666352075049206*^9, 3.666352076256692*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"archit", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"2", ",", " ", "2", ",", " ", "1"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<\[Theta]\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "<>", 
         RowBox[{"ToString", "[", "j", "]"}], "<>", 
         RowBox[{"ToString", "[", "k", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", " ", 
         RowBox[{"archit", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"k", ",", " ", "0", ",", " ", 
         RowBox[{"archit", "[", 
          RowBox[{"[", 
           RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", " ", 
       RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Theta]AllTmp", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"\[Theta]", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", 
      RowBox[{"Length", "[", "\[Theta]", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", " ", 
    RowBox[{"i", "<", 
     RowBox[{"Length", "[", "archit", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Superscript", "[", 
       RowBox[{"\"\<\[Theta]\>\"", ",", " ", "i"}], "]"}], ",", "\"\< = \>\"",
       ",", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"\[Theta]", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"[", 
       RowBox[{"2", " ", "5", " ", "6", " ", "3"}], "]"}], " ", 
      "\[Theta]fix"}], " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.034225", ",", 
           RowBox[{"-", "0.454284"}], ",", 
           RowBox[{"-", "2.652881"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.203030", ",", 
           RowBox[{"-", "0.686212"}], ",", 
           RowBox[{"-", "2.401099"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.965855", ",", "0.239303", ",", 
           RowBox[{"-", "0.456707"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.967651"}], ",", 
           RowBox[{"-", "2.484711"}], ",", 
           RowBox[{"-", "0.578450"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.837095", ",", "0.756525", ",", 
           RowBox[{"-", "2.058914"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.1434968"}], ",", 
           RowBox[{"-", "2.7254714"}], ",", 
           RowBox[{"-", "0.6940123"}], ",", 
           RowBox[{"-", "2.0796824"}], ",", 
           RowBox[{"-", "1.0235599"}], ",", 
           RowBox[{"-", "0.9798576"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.6744904"}], ",", 
           RowBox[{"-", "0.4115589"}], ",", 
           RowBox[{"-", "1.7588500"}], ",", 
           RowBox[{"-", "2.9772614"}], ",", 
           RowBox[{"-", "0.6937645"}], ",", 
           RowBox[{"-", "2.0625809"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.8347321"}], ",", 
           RowBox[{"-", "0.0015962"}], ",", "0.0044307", ",", 
           RowBox[{"-", "2.8260281"}], ",", 
           RowBox[{"-", "1.6520862"}], ",", 
           RowBox[{"-", "0.2487677"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.8337728"}], ",", 
           RowBox[{"-", "0.6374790"}], ",", 
           RowBox[{"-", "1.8227457"}], ",", 
           RowBox[{"-", "1.1440733"}], ",", 
           RowBox[{"-", "1.6668174"}], ",", 
           RowBox[{"-", "2.0439432"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.1060973"}], ",", "0.2822872", ",", 
           RowBox[{"-", "2.2101957"}], ",", 
           RowBox[{"-", "1.3606613"}], ",", 
           RowBox[{"-", "0.8578750"}], ",", "0.3521685"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.5935213"}], ",", 
           RowBox[{"-", "0.8815364"}], ",", 
           RowBox[{"-", "2.1519084"}], ",", "0.6735250", ",", "0.0852290", 
           ",", "0.7672503"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.28990", ",", "0.82255", ",", 
           RowBox[{"-", "0.88405"}], ",", "0.30355", ",", 
           RowBox[{"-", "0.80178"}], ",", 
           RowBox[{"-", "0.41216"}], ",", 
           RowBox[{"-", "2.65119"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.54181", ",", "0.33694", ",", 
           RowBox[{"-", "1.60065"}], ",", 
           RowBox[{"-", "2.56335"}], ",", "0.79371", ",", 
           RowBox[{"-", "2.51547"}], ",", 
           RowBox[{"-", "0.53684"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.85514"}], ",", 
           RowBox[{"-", "2.82926"}], ",", 
           RowBox[{"-", "0.35671"}], ",", 
           RowBox[{"-", "1.03435"}], ",", 
           RowBox[{"-", "0.26898"}], ",", 
           RowBox[{"-", "1.71319"}], ",", 
           RowBox[{"-", "1.31152"}]}], "}"}]}], "}"}]}], "}"}]}], ";"}], 
   "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"rule\[Theta]", " ", "=", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]fix", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"k", ",", " ", "1", ",", " ", 
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{"\[Theta]", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", " ", 
         RowBox[{"Length", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"rule\[Theta]", " ", "=", 
  RowBox[{"Flatten", "[", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]AllTmp", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{
           SqrtBox[
            FractionBox["6", 
             RowBox[{
              RowBox[{"archit", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", 
              RowBox[{"archit", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}]]], 
           RowBox[{"Sin", "[", "j", "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"6", ",", " ", "6"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"\[Theta]AllTmp", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]AllTmp", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzVtIk3Ech/EXEXGYqai0NM8ztmgk05GnoRu7KDFxu0lmBxu1YF0kHsq0
0kTE8wlvBnojicK8WJCihF3MiTYl2iQKHc5lrwgvio7XgTTI//d38fC5fLLM
L43PIjiOy2XB4+CcM1AtaPVa7zq0hPz/YFSNJgy/rV7Xi8yUrglyOGi3wcr/
v0jV59beM+bjqg7yllVTHmI6A/ukmOdwcwZB2257vQHlIyo/5Bf0ZF2i/SSC
WZuhDsJ+oWztJrPCt+mGiafWI6irdpByV/eyknl8e4mciG3bhF3p4+QP6V8R
Zsviz+GlFzd8TUyrYYuMHhD2YMu9awG4t/O+8AMzXLxdBCtXJnehZ17ih3PT
Eq4T3zFTJGzZUUrhcswTcuZVrQKGwhbSkfTQAH3t/aRi//4j2HzVTMqeNzyF
NWEvGSxqmIU/oxrJqfq3X+CiTvkV3h1XO2GTum4V9oUcHij28F64rnPzKqOg
vdyjOYBDk1PnMG3DRW6XHiXnMz9ViVdgYcdoCVxrjiuF8rMHesh7A3dg5vSi
Cf4u+fgGGg8bJQXMFI2d/DNklkLZd1sq5GN3c+DguwQFvAA1Iigv
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6662841046755877`*^9, 3.666284514432024*^9, 3.6663207036810846`*^9, 
   3.6663219573873262`*^9, 3.6663220525366716`*^9, 3.6663226394531975`*^9, 
   3.666324557249067*^9, 3.6663257503743916`*^9, 3.666326023728554*^9, 
   3.6663477710436883`*^9, {3.6663520185414333`*^9, 3.6663520451431537`*^9}, {
   3.6664377054046803`*^9, 3.6664377214150996`*^9}, 3.6664379982140827`*^9, 
   3.666439662419331*^9, 3.6664397810779076`*^9, 3.666439923129861*^9, 
   3.6664401375518312`*^9, 3.6665853567540097`*^9, 3.6666119612768354`*^9, {
   3.666612246843527*^9, 3.6666122596416683`*^9}, {3.666612539270975*^9, 
   3.666612556044712*^9}, 3.666612878383171*^9, 3.666612980344124*^9, 
   3.666613036004476*^9, {3.6666137808076096`*^9, 3.6666138037748337`*^9}, 
   3.6666139119262705`*^9, 3.6666143081253953`*^9, 3.666668087352634*^9, 
   3.6666716212011366`*^9, 3.6666717465855374`*^9, 3.6669745149959197`*^9, 
   3.6669746707208266`*^9, 3.666975275972445*^9, 3.6669754816412086`*^9, {
   3.6669756514379206`*^9, 3.6669756936813364`*^9}, 3.666976845933242*^9, {
   3.6669769655580835`*^9, 3.6669769894304495`*^9}, {3.6669770617105837`*^9, 
   3.666977097096607*^9}, 3.6669776008964233`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Theta]110", ",", "\[Theta]111", ",", "\[Theta]112", ",", "\[Theta]120",
      ",", "\[Theta]121", ",", "\[Theta]122"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]210", ",", "\[Theta]211", ",", "\[Theta]212"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6662841046755877`*^9, 3.666284514432024*^9, 3.6663207036810846`*^9, 
   3.6663219573873262`*^9, 3.6663220525366716`*^9, 3.6663226394531975`*^9, 
   3.666324557249067*^9, 3.6663257503743916`*^9, 3.666326023728554*^9, 
   3.6663477710436883`*^9, {3.6663520185414333`*^9, 3.6663520451431537`*^9}, {
   3.6664377054046803`*^9, 3.6664377214150996`*^9}, 3.6664379982140827`*^9, 
   3.666439662419331*^9, 3.6664397810779076`*^9, 3.666439923129861*^9, 
   3.6664401375518312`*^9, 3.6665853567540097`*^9, 3.6666119612768354`*^9, {
   3.666612246843527*^9, 3.6666122596416683`*^9}, {3.666612539270975*^9, 
   3.666612556044712*^9}, 3.666612878383171*^9, 3.666612980344124*^9, 
   3.666613036004476*^9, {3.6666137808076096`*^9, 3.6666138037748337`*^9}, 
   3.6666139119262705`*^9, 3.6666143081253953`*^9, 3.666668087352634*^9, 
   3.6666716212011366`*^9, 3.6666717465855374`*^9, 3.6669745149959197`*^9, 
   3.6669746707208266`*^9, 3.666975275972445*^9, 3.6669754816412086`*^9, {
   3.6669756514379206`*^9, 3.6669756936813364`*^9}, 3.666976845933242*^9, {
   3.6669769655580835`*^9, 3.6669769894304495`*^9}, {3.6669770617105837`*^9, 
   3.666977097096607*^9}, 3.666977600927425*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TemplateBox[{"\"\[Theta]\"","1"},
    "Superscript"], "\[InvisibleSpace]", "\<\" = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"\[Theta]110", "\[Theta]111", "\[Theta]112"},
       {"\[Theta]120", "\[Theta]121", "\[Theta]122"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
   Superscript["\[Theta]", 1], " = ", 
   MatrixForm[{{$CellContext`\[Theta]110, $CellContext`\[Theta]111, \
$CellContext`\[Theta]112}, {$CellContext`\[Theta]120, \
$CellContext`\[Theta]121, $CellContext`\[Theta]122}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.666326023730554*^9, 3.666347771046689*^9, {3.666352018562442*^9, 
   3.6663520451641626`*^9}, {3.6664377054416957`*^9, 3.6664377214171004`*^9}, 
   3.666437998218089*^9, 3.666439662422332*^9, 3.666439781080907*^9, 
   3.66643992314987*^9, 3.666440137555833*^9, 3.666585356861053*^9, 
   3.6666119612808375`*^9, {3.666612246846529*^9, 3.6666122596446695`*^9}, {
   3.6666125392739763`*^9, 3.6666125560477133`*^9}, 3.666612878386338*^9, 
   3.6666129803471227`*^9, 3.6666130360064774`*^9, {3.666613780810611*^9, 
   3.6666138037798357`*^9}, 3.6666139119292784`*^9, 3.6666143081273975`*^9, 
   3.6666680874866877`*^9, 3.6666716212031374`*^9, 3.666671746608547*^9, 
   3.666974515108926*^9, 3.6669746707258267`*^9, 3.666975275987446*^9, 
   3.666975481654209*^9, {3.666975651445921*^9, 3.6669756936983376`*^9}, 
   3.6669768459472427`*^9, {3.6669769655720844`*^9, 3.66697698944545*^9}, {
   3.6669770617355847`*^9, 3.6669770971096077`*^9}, 3.6669776009534264`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TemplateBox[{"\"\[Theta]\"","2"},
    "Superscript"], "\[InvisibleSpace]", "\<\" = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"\[Theta]210", "\[Theta]211", "\[Theta]212"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
   Superscript["\[Theta]", 2], " = ", 
   MatrixForm[{{$CellContext`\[Theta]210, $CellContext`\[Theta]211, \
$CellContext`\[Theta]212}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.666326023730554*^9, 3.666347771046689*^9, {3.666352018562442*^9, 
   3.6663520451641626`*^9}, {3.6664377054416957`*^9, 3.6664377214171004`*^9}, 
   3.666437998218089*^9, 3.666439662422332*^9, 3.666439781080907*^9, 
   3.66643992314987*^9, 3.666440137555833*^9, 3.666585356861053*^9, 
   3.6666119612808375`*^9, {3.666612246846529*^9, 3.6666122596446695`*^9}, {
   3.6666125392739763`*^9, 3.6666125560477133`*^9}, 3.666612878386338*^9, 
   3.6666129803471227`*^9, 3.6666130360064774`*^9, {3.666613780810611*^9, 
   3.6666138037798357`*^9}, 3.6666139119292784`*^9, 3.6666143081273975`*^9, 
   3.6666680874866877`*^9, 3.6666716212031374`*^9, 3.666671746608547*^9, 
   3.666974515108926*^9, 3.6669746707258267`*^9, 3.666975275987446*^9, 
   3.666975481654209*^9, {3.666975651445921*^9, 3.6669756936983376`*^9}, 
   3.6669768459472427`*^9, {3.6669769655720844`*^9, 3.66697698944545*^9}, {
   3.6669770617355847`*^9, 3.6669770971096077`*^9}, 3.6669776009584265`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
   "\[Theta]110", "\[Rule]", "1.03058727306830098960649165077761714322`6."}], 
   ",", 
   RowBox[{
   "\[Theta]111", "\[Rule]", "1.11365736007432238223337037920822863191`6."}], 
   ",", 
   RowBox[{
   "\[Theta]112", "\[Rule]", 
    "0.17283600612206209097386114819413132209`5.237634222119691"}], ",", 
   RowBox[{"\[Theta]120", "\[Rule]", 
    RowBox[{
    "-", "0.92688997478474226099774956686365878825`5.9670281848675035"}]}], 
   ",", 
   RowBox[{"\[Theta]121", "\[Rule]", 
    RowBox[{"-", "1.17443758744657833741262733845975852423`6."}]}], ",", 
   RowBox[{"\[Theta]122", "\[Rule]", 
    RowBox[{
    "-", "0.34221269840646024967829159213613476464`5.534296120767717"}]}], 
   ",", 
   RowBox[{
   "\[Theta]210", "\[Rule]", "1.19001967905877186254249922268472325279`6."}], 
   ",", 
   RowBox[{
   "\[Theta]211", "\[Rule]", "1.28594075324783603136098194900935251454`6."}], 
   ",", 
   RowBox[{
   "\[Theta]212", "\[Rule]", 
    "0.19957382932046470970813029775752654774`5.3001035904238405"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6662841046755877`*^9, 3.666284514432024*^9, 3.6663207036810846`*^9, 
   3.6663219573873262`*^9, 3.6663220525366716`*^9, 3.6663226394531975`*^9, 
   3.666324557249067*^9, 3.6663257503743916`*^9, 3.666326023728554*^9, 
   3.6663477710436883`*^9, {3.6663520185414333`*^9, 3.6663520451431537`*^9}, {
   3.6664377054046803`*^9, 3.6664377214150996`*^9}, 3.6664379982140827`*^9, 
   3.666439662419331*^9, 3.6664397810779076`*^9, 3.666439923129861*^9, 
   3.6664401375518312`*^9, 3.6665853567540097`*^9, 3.6666119612768354`*^9, {
   3.666612246843527*^9, 3.6666122596416683`*^9}, {3.666612539270975*^9, 
   3.666612556044712*^9}, 3.666612878383171*^9, 3.666612980344124*^9, 
   3.666613036004476*^9, {3.6666137808076096`*^9, 3.6666138037748337`*^9}, 
   3.6666139119262705`*^9, 3.6666143081253953`*^9, 3.666668087352634*^9, 
   3.6666716212011366`*^9, 3.6666717465855374`*^9, 3.6669745149959197`*^9, 
   3.6669746707208266`*^9, 3.666975275972445*^9, 3.6669754816412086`*^9, {
   3.6669756514379206`*^9, 3.6669756936813364`*^9}, 3.666976845933242*^9, {
   3.6669769655580835`*^9, 3.6669769894304495`*^9}, {3.6669770617105837`*^9, 
   3.666977097096607*^9}, 3.6669776009634266`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", " ", 
       RowBox[{"-", "3"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"2", ",", " ", 
       RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", " ", 
     RowBox[{"{", "0", "}"}], ",", " ", 
     RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputSize", " ", "=", " ", 
   RowBox[{"Length", "[", "X", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6663261632467785`*^9, 3.66632621737059*^9}, {
  3.66632629086821*^9, 3.666326291355406*^9}, {3.666335637014693*^9, 
  3.6663356704941845`*^9}, {3.6663454214948225`*^9, 3.666345453559745*^9}, {
  3.666347176881241*^9, 3.666347176985283*^9}, {3.6663473039634542`*^9, 
  3.666347342899146*^9}, {3.666347437461254*^9, 3.6663474377013507`*^9}, {
  3.666347510917857*^9, 3.6663475396304283`*^9}, {3.6663476160482244`*^9, 
  3.666347629183518*^9}, {3.666347680465184*^9, 3.666347689928998*^9}, {
  3.666347775794602*^9, 3.666347784050929*^9}, {3.666438028154084*^9, 
  3.666438035521038*^9}, {3.6665853750713673`*^9, 3.666585403831918*^9}, {
  3.6666119950624046`*^9, 3.6666120009177575`*^9}, {3.666614252067881*^9, 
  3.6666142643248034`*^9}, {3.666976325911498*^9, 3.6669763332019153`*^9}, {
  3.666977516906619*^9, 3.6669775313574457`*^9}, {3.6669777738353148`*^9, 
  3.6669777934164343`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"A", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<a\>\"", "<>", 
          RowBox[{"ToString", "[", "a", "]"}], "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", 
          RowBox[{"archit", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "X", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Z", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<z\>\"", "<>", 
          RowBox[{"ToString", "[", "a", "]"}], "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", 
          RowBox[{"archit", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "X", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6662909105658617`*^9, 3.666291055416147*^9}, {
  3.666291150679596*^9, 3.666291150997614*^9}, {3.666291866424534*^9, 
  3.666291866507539*^9}, {3.6663207111711025`*^9, 3.6663207193223877`*^9}, {
  3.6663231761905017`*^9, 3.666323182182917*^9}, {3.6663263020537176`*^9, 
  3.6663263993029084`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a111", ",", "a112"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a121", ",", "a122"}], "}"}], ",", 
     RowBox[{"{", "a131", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a211", ",", "a212"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a221", ",", "a222"}], "}"}], ",", 
     RowBox[{"{", "a231", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a311", ",", "a312"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a321", ",", "a322"}], "}"}], ",", 
     RowBox[{"{", "a331", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.666291007485406*^9, 3.666291020185132*^9}, 
   3.666291056074185*^9, 3.666291151783659*^9, 3.6662918670105677`*^9, 
   3.666320720018668*^9, 3.666321959684252*^9, 3.6663220540132666`*^9, 
   3.666322641847163*^9, 3.66632456219506*^9, 3.6663257607165594`*^9, 
   3.666326043874673*^9, 3.6663263517257357`*^9, {3.666326395607419*^9, 
   3.6663263996280403`*^9}, 3.666345455128377*^9, 3.6663455342432604`*^9, 
   3.6663470198969765`*^9, 3.6663471783788443`*^9, 3.6663473145407176`*^9, 
   3.6663473447749023`*^9, 3.6663474392329683`*^9, {3.6663475155277147`*^9, 
   3.666347541336116*^9}, 3.6663476311853247`*^9, 3.666347693619486*^9, 
   3.6663477889479027`*^9, 3.666352047540119*^9, 3.6664377287030215`*^9, 
   3.6664380007701054`*^9, 3.666438037002633*^9, 3.6664397828486166`*^9, 
   3.6664399250746403`*^9, 3.6664401411652803`*^9, 3.6665854120012016`*^9, 
   3.6666120029965916`*^9, 3.666612262638872*^9, {3.6666125409396443`*^9, 
   3.6666125577704043`*^9}, 3.6666130398970394`*^9, 3.6666139138361816`*^9, 
   3.666614310696428*^9, 3.6666680932390003`*^9, 3.6666716244884577`*^9, 
   3.666671749185582*^9, 3.666977606752758*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z111", ",", "z112"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z121", ",", "z122"}], "}"}], ",", 
     RowBox[{"{", "z131", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z211", ",", "z212"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z221", ",", "z222"}], "}"}], ",", 
     RowBox[{"{", "z231", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z311", ",", "z312"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z321", ",", "z322"}], "}"}], ",", 
     RowBox[{"{", "z331", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.666291007485406*^9, 3.666291020185132*^9}, 
   3.666291056074185*^9, 3.666291151783659*^9, 3.6662918670105677`*^9, 
   3.666320720018668*^9, 3.666321959684252*^9, 3.6663220540132666`*^9, 
   3.666322641847163*^9, 3.66632456219506*^9, 3.6663257607165594`*^9, 
   3.666326043874673*^9, 3.6663263517257357`*^9, {3.666326395607419*^9, 
   3.6663263996280403`*^9}, 3.666345455128377*^9, 3.6663455342432604`*^9, 
   3.6663470198969765`*^9, 3.6663471783788443`*^9, 3.6663473145407176`*^9, 
   3.6663473447749023`*^9, 3.6663474392329683`*^9, {3.6663475155277147`*^9, 
   3.666347541336116*^9}, 3.6663476311853247`*^9, 3.666347693619486*^9, 
   3.6663477889479027`*^9, 3.666352047540119*^9, 3.6664377287030215`*^9, 
   3.6664380007701054`*^9, 3.666438037002633*^9, 3.6664397828486166`*^9, 
   3.6664399250746403`*^9, 3.6664401411652803`*^9, 3.6665854120012016`*^9, 
   3.6666120029965916`*^9, 3.666612262638872*^9, {3.6666125409396443`*^9, 
   3.6666125577704043`*^9}, 3.6666130398970394`*^9, 3.6666139138361816`*^9, 
   3.666614310696428*^9, 3.6666680932390003`*^9, 3.6666716244884577`*^9, 
   3.666671749185582*^9, 3.666977606757758*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"h", "[", "x_", "]"}], "=", 
   FractionBox["1", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "x"}]]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.666284545988829*^9, 3.6662845862261305`*^9}, 
   3.666324569659067*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ruleA", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"[", "a", "]"}], "]"}], "[", 
            RowBox[{"[", "l", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}], "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"l", "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", "a", "]"}], "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"h", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Z", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "[", 
               RowBox[{"[", "l", "]"}], "]"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", " ", "1", ",", " ", 
           RowBox[{"archit", "[", 
            RowBox[{"[", "l", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", " ", 
         RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", " ", "inputSize"}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ruleZ", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Z", "[", 
             RowBox[{"[", "a", "]"}], "]"}], "[", 
            RowBox[{"[", "l", "]"}], "]"}], "[", 
           RowBox[{"[", "k", "]"}], "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"[", 
              RowBox[{"l", "-", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "k", "]"}], "]"}], " ", ".", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", " ", 
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", "a", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"l", "-", "1"}], "]"}], "]"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", " ", "1", ",", " ", 
           RowBox[{"archit", "[", 
            RowBox[{"[", "l", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "2", ",", " ", 
         RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", " ", "inputSize"}], "}"}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.666285763870488*^9, 3.6662857838046284`*^9}, {
   3.6662863647198544`*^9, 3.66628641481472*^9}, {3.666286450172742*^9, 
   3.6662865872455826`*^9}, {3.666286629093976*^9, 3.6662866320011425`*^9}, 
   3.666286684564149*^9, {3.666286722315308*^9, 3.666286878005213*^9}, {
   3.6662869129682126`*^9, 3.666286970039477*^9}, {3.666287005387499*^9, 
   3.6662870955966587`*^9}, {3.666287137726068*^9, 3.6662871825716333`*^9}, {
   3.6662872220408907`*^9, 3.6662872383328223`*^9}, {3.6662874587524295`*^9, 
   3.666287700128236*^9}, {3.6662877732274165`*^9, 3.6662877797647905`*^9}, {
   3.6662878367290487`*^9, 3.6662878518549137`*^9}, {3.6662881033723*^9, 
   3.6662881590974874`*^9}, {3.666290171884612*^9, 3.6662903249963694`*^9}, {
   3.666291186619652*^9, 3.6662911993133774`*^9}, {3.6662916174822955`*^9, 
   3.6662916730584745`*^9}, 3.666292034966174*^9, {3.6663207501087947`*^9, 
   3.6663207594615636`*^9}, {3.6663220428477664`*^9, 3.666322043206911*^9}, {
   3.666323140232011*^9, 3.6663231403360524`*^9}, {3.6663231969368625`*^9, 
   3.666323204729003*^9}, {3.666324356746264*^9, 3.6663243859060154`*^9}, {
   3.6663355776157546`*^9, 3.6663356051688585`*^9}, {3.666335679776925*^9, 
   3.6663357453383465`*^9}, {3.666335776155766*^9, 3.6663357774772987`*^9}, {
   3.666345479267105*^9, 3.6663454852985353`*^9}, {3.666345609668657*^9, 
   3.6663457137666073`*^9}, {3.6663458206796937`*^9, 
   3.6663458212079067`*^9}, {3.666345856281041*^9, 3.6663459327778687`*^9}, {
   3.6663459798918557`*^9, 3.6663459806601653`*^9}, {3.6663460228531694`*^9, 
   3.666346089250928*^9}, {3.666346389367874*^9, 3.666346389831061*^9}, {
   3.666346866816285*^9, 3.6663469451528544`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a111", "\[Rule]", "3"}], ",", 
   RowBox[{"a112", "\[Rule]", "2"}], ",", 
   RowBox[{"a121", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z121"}]]}]]}], ",", 
   RowBox[{"a122", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z122"}]]}]]}], ",", 
   RowBox[{"a131", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z131"}]]}]]}], ",", 
   RowBox[{"a211", "\[Rule]", "1"}], ",", 
   RowBox[{"a212", "\[Rule]", "0"}], ",", 
   RowBox[{"a221", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z221"}]]}]]}], ",", 
   RowBox[{"a222", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z222"}]]}]]}], ",", 
   RowBox[{"a231", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z231"}]]}]]}], ",", 
   RowBox[{"a311", "\[Rule]", 
    RowBox[{"-", "2"}]}], ",", 
   RowBox[{"a312", "\[Rule]", "1"}], ",", 
   RowBox[{"a321", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z321"}]]}]]}], ",", 
   RowBox[{"a322", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z322"}]]}]]}], ",", 
   RowBox[{"a331", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z331"}]]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.666291673985527*^9, 3.666291870054742*^9, 3.66629203611524*^9, 
   3.666320760104823*^9, 3.666321966592036*^9, {3.666322044238327*^9, 
   3.666322055865013*^9}, 3.6663226434488087`*^9, 3.6663231435533495`*^9, 
   3.6663232052922316`*^9, {3.666324362411548*^9, 3.6663243863021755`*^9}, {
   3.666324565639448*^9, 3.666324570844546*^9}, 3.666325765240383*^9, 
   3.6663356074637837`*^9, 3.6663357470150223`*^9, 3.666335777788424*^9, 
   3.6663454588198647`*^9, 3.666345714236799*^9, 3.666345873925152*^9, 
   3.6663460922951546`*^9, 3.6663463905243406`*^9, {3.6663469332030396`*^9, 
   3.6663469460932336`*^9}, 3.6663470212645283`*^9, 3.666347180206581*^9, 
   3.6663473158792567`*^9, 3.6663473462655025`*^9, 3.666347441289798*^9, {
   3.6663475171543713`*^9, 3.666347542657648*^9}, 3.666347634355604*^9, 
   3.6663476950700703`*^9, 3.66634779097472*^9, 3.666352049258812*^9, 
   3.66643774827387*^9, {3.66643801609525*^9, 3.6664380381090765`*^9}, 
   3.6664397840912285`*^9, 3.666439926324141*^9, 3.6664401423597603`*^9, 
   3.6665854137388973`*^9, 3.6666120049243655`*^9, 3.6666122644666047`*^9, {
   3.6666125423014936`*^9, 3.6666125589958997`*^9}, 3.6666130416687517`*^9, 
   3.66661391511255*^9, 3.666614311894909*^9, 3.666668094840644*^9, 
   3.6666716303348074`*^9, 3.6666717510953493`*^9, 3.66697760853686*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"z121", "\[Rule]", 
    RowBox[{"\[Theta]110", "+", 
     RowBox[{"a111", " ", "\[Theta]111"}], "+", 
     RowBox[{"a112", " ", "\[Theta]112"}]}]}], ",", 
   RowBox[{"z122", "\[Rule]", 
    RowBox[{"\[Theta]120", "+", 
     RowBox[{"a111", " ", "\[Theta]121"}], "+", 
     RowBox[{"a112", " ", "\[Theta]122"}]}]}], ",", 
   RowBox[{"z131", "\[Rule]", 
    RowBox[{"\[Theta]210", "+", 
     RowBox[{"a121", " ", "\[Theta]211"}], "+", 
     RowBox[{"a122", " ", "\[Theta]212"}]}]}], ",", 
   RowBox[{"z221", "\[Rule]", 
    RowBox[{"\[Theta]110", "+", 
     RowBox[{"a211", " ", "\[Theta]111"}], "+", 
     RowBox[{"a212", " ", "\[Theta]112"}]}]}], ",", 
   RowBox[{"z222", "\[Rule]", 
    RowBox[{"\[Theta]120", "+", 
     RowBox[{"a211", " ", "\[Theta]121"}], "+", 
     RowBox[{"a212", " ", "\[Theta]122"}]}]}], ",", 
   RowBox[{"z231", "\[Rule]", 
    RowBox[{"\[Theta]210", "+", 
     RowBox[{"a221", " ", "\[Theta]211"}], "+", 
     RowBox[{"a222", " ", "\[Theta]212"}]}]}], ",", 
   RowBox[{"z321", "\[Rule]", 
    RowBox[{"\[Theta]110", "+", 
     RowBox[{"a311", " ", "\[Theta]111"}], "+", 
     RowBox[{"a312", " ", "\[Theta]112"}]}]}], ",", 
   RowBox[{"z322", "\[Rule]", 
    RowBox[{"\[Theta]120", "+", 
     RowBox[{"a311", " ", "\[Theta]121"}], "+", 
     RowBox[{"a312", " ", "\[Theta]122"}]}]}], ",", 
   RowBox[{"z331", "\[Rule]", 
    RowBox[{"\[Theta]210", "+", 
     RowBox[{"a321", " ", "\[Theta]211"}], "+", 
     RowBox[{"a322", " ", "\[Theta]212"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.666291673985527*^9, 3.666291870054742*^9, 3.66629203611524*^9, 
   3.666320760104823*^9, 3.666321966592036*^9, {3.666322044238327*^9, 
   3.666322055865013*^9}, 3.6663226434488087`*^9, 3.6663231435533495`*^9, 
   3.6663232052922316`*^9, {3.666324362411548*^9, 3.6663243863021755`*^9}, {
   3.666324565639448*^9, 3.666324570844546*^9}, 3.666325765240383*^9, 
   3.6663356074637837`*^9, 3.6663357470150223`*^9, 3.666335777788424*^9, 
   3.6663454588198647`*^9, 3.666345714236799*^9, 3.666345873925152*^9, 
   3.6663460922951546`*^9, 3.6663463905243406`*^9, {3.6663469332030396`*^9, 
   3.6663469460932336`*^9}, 3.6663470212645283`*^9, 3.666347180206581*^9, 
   3.6663473158792567`*^9, 3.6663473462655025`*^9, 3.666347441289798*^9, {
   3.6663475171543713`*^9, 3.666347542657648*^9}, 3.666347634355604*^9, 
   3.6663476950700703`*^9, 3.66634779097472*^9, 3.666352049258812*^9, 
   3.66643774827387*^9, {3.66643801609525*^9, 3.6664380381090765`*^9}, 
   3.6664397840912285`*^9, 3.666439926324141*^9, 3.6664401423597603`*^9, 
   3.6665854137388973`*^9, 3.6666120049243655`*^9, 3.6666122644666047`*^9, {
   3.6666125423014936`*^9, 3.6666125589958997`*^9}, 3.6666130416687517`*^9, 
   3.66661391511255*^9, 3.666614311894909*^9, 3.666668094840644*^9, 
   3.6666716303348074`*^9, 3.6666717510953493`*^9, 3.666977608571862*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"J", " ", "[", " ", 
   RowBox[{"Y_", ",", " ", "\[Theta]_", ",", "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "inputSize"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"Y", "[", 
             RowBox[{"[", "a", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], 
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", "a", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"Y", "[", 
              RowBox[{"[", "a", "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", "a", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"Y", "[", 
            RowBox[{"[", "a", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "1", ",", " ", "inputSize"}], "}"}]}], "]"}]}], 
   "+", 
   RowBox[{
    FractionBox["\[Lambda]", 
     RowBox[{"2", "inputSize"}]], 
    RowBox[{"Tr", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "\[Theta]", "]"}], " ", "^", "2"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6662846018580246`*^9, 3.6662846160098343`*^9}, {
   3.6662846464095726`*^9, 3.666284671989036*^9}, {3.6662847109462643`*^9, 
   3.666284750665536*^9}, 3.666285190010665*^9, {3.6662852344242053`*^9, 
   3.6662852981698513`*^9}, {3.6662853442594876`*^9, 
   3.6662854565759115`*^9}, {3.666285527825987*^9, 3.6662855512033243`*^9}, {
   3.6662884796128197`*^9, 3.6662885504698725`*^9}, {3.6662900999264965`*^9, 
   3.6662901254439554`*^9}, {3.6662904702506776`*^9, 3.666290477553095*^9}, {
   3.666320847068869*^9, 3.666320908053446*^9}, {3.666340568097911*^9, 
   3.666340589278447*^9}, {3.666340666938744*^9, 3.6663406808033314`*^9}, {
   3.6663453596478987`*^9, 3.6663453678962226`*^9}, {3.6663471334657445`*^9, 
   3.666347142655448*^9}, {3.6664394750702143`*^9, 3.666439504559037*^9}, {
   3.666439619332055*^9, 3.6664396268880844`*^9}, {3.66643973489739*^9, 
   3.666439736041849*^9}, 3.666439965588884*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"costF", "=", 
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{"Y", ",", "\[Theta]", ",", " ", "\[Lambda]"}], "]"}], "//.", 
   RowBox[{"Join", "[", 
    RowBox[{"ruleA", ",", "ruleZ"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6662885551451397`*^9, 3.666288593838353*^9}, {
   3.666290129785204*^9, 3.6662901299552135`*^9}, {3.6662903709779997`*^9, 
   3.6662903738451633`*^9}, {3.666290407141068*^9, 3.666290438858882*^9}, 
   3.6662904922119336`*^9, {3.66632091798845*^9, 3.666320924868222*^9}, 
   3.6663220629018483`*^9, {3.6663220953259153`*^9, 3.6663220972857046`*^9}, {
   3.666340440517497*^9, 3.666340442469283*^9}, {3.666340709168763*^9, 
   3.6663407305853944`*^9}, {3.6663464412147684`*^9, 
   3.6663464509266825`*^9}, {3.666348157032241*^9, 3.666348159767343*^9}, {
   3.6663483618027625`*^9, 3.666348367002858*^9}, {3.666439750246544*^9, 
   3.666439751262952*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "6"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[Theta]110", "2"], "+", 
     SuperscriptBox["\[Theta]111", "2"], "+", 
     SuperscriptBox["\[Theta]112", "2"], "+", 
     SuperscriptBox["\[Theta]120", "2"], "+", 
     SuperscriptBox["\[Theta]121", "2"], "+", 
     SuperscriptBox["\[Theta]122", "2"], "+", 
     SuperscriptBox["\[Theta]210", "2"], "+", 
     SuperscriptBox["\[Theta]211", "2"], "+", 
     SuperscriptBox["\[Theta]212", "2"]}], ")"}], " ", "\[Lambda]"}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Log", "[", 
       FractionBox["1", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[Theta]210"}], "-", 
           FractionBox["\[Theta]211", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Theta]110"}], "-", 
               RowBox[{"3", " ", "\[Theta]111"}], "-", 
               RowBox[{"2", " ", "\[Theta]112"}]}]]}]], "-", 
           FractionBox["\[Theta]212", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Theta]120"}], "-", 
               RowBox[{"3", " ", "\[Theta]121"}], "-", 
               RowBox[{"2", " ", "\[Theta]122"}]}]]}]]}]]}]], "]"}]}], "-", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[Theta]210"}], "-", 
           FractionBox["\[Theta]211", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Theta]110"}], "-", "\[Theta]111"}]]}]], "-", 
           FractionBox["\[Theta]212", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Theta]120"}], "-", "\[Theta]121"}]]}]]}]]}]]}],
       "]"}], "-", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[Theta]210"}], "-", 
           FractionBox["\[Theta]211", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Theta]110"}], "+", 
               RowBox[{"2", " ", "\[Theta]111"}], "-", "\[Theta]112"}]]}]], 
           "-", 
           FractionBox["\[Theta]212", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Theta]120"}], "+", 
               RowBox[{"2", " ", "\[Theta]121"}], "-", 
               "\[Theta]122"}]]}]]}]]}]]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.6662885845418215`*^9, 3.666288594395385*^9}, {
   3.6662901083659787`*^9, 3.66629013041224*^9}, 3.6662903744481983`*^9, {
   3.6662904080061173`*^9, 3.6662904397919354`*^9}, {3.666290479312196*^9, 
   3.6662904928159685`*^9}, {3.6663209111777053`*^9, 3.6663209256285295`*^9}, 
   3.6663219704685984`*^9, 3.66632206364815*^9, 3.6663220978419294`*^9, 
   3.6663226455056367`*^9, 3.6663243963622293`*^9, 3.6663245726452713`*^9, 
   3.666325835397656*^9, 3.6663259199667373`*^9, 3.666340418172492*^9, 
   3.6663404636848345`*^9, {3.666340682841153*^9, 3.6663407312816744`*^9}, 
   3.6663453700510917`*^9, 3.666346408134437*^9, 3.666346451706997*^9, 
   3.666347033792577*^9, 3.666347145706678*^9, 3.6663471817311954`*^9, 
   3.6663473176629777`*^9, 3.666347349765913*^9, {3.666347519454298*^9, 
   3.666347547560624*^9}, 3.666347698828585*^9, 3.666347794398101*^9, 
   3.666348160241534*^9, 3.66634836750206*^9, 3.66635205123761*^9, 
   3.6664377546244144`*^9, 3.6664380396196814`*^9, {3.66643973956026*^9, 
   3.6664397518411846`*^9}, 3.6664397855577016`*^9, 3.666439858899108*^9, {
   3.666439904792508*^9, 3.6664399280428305`*^9}, 3.6664399677747602`*^9, 
   3.6664401447016983`*^9, 3.6665854177315006`*^9, 3.666612006718088*^9, 
   3.666612267577854*^9, {3.6666125440679035`*^9, 3.666612560433474*^9}, 
   3.66661304490305*^9, 3.666613916563134*^9, 3.666614313585588*^9, 
   3.6666680979378896`*^9, 3.6666716339862757`*^9, 3.6666717535103207`*^9, 
   3.6669776107469864`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivatives", "Subsection",
 CellChangeTimes->{{3.6663482780640163`*^9, 3.6663482852088957`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]flat", " ", "=", " ", 
   RowBox[{"Flatten", "[", "\[Theta]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costF", "=", 
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{"Y", ",", "\[Theta]", ",", " ", "0"}], "]"}], "//.", 
    RowBox[{"Join", "[", 
     RowBox[{"ruleA", ",", "ruleZ"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.666348312113738*^9, 3.666348322858068*^9}, {
   3.666348596286259*^9, 3.6663485995985937`*^9}, {3.6664398460639615`*^9, 
   3.6664398514241104`*^9}, 3.6665858036554985`*^9, {3.6669776588277364`*^9, 
   3.6669776590527496`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Architecture: \>\"", ",", " ", "archit"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<J=\>\"", ",", " ", 
    RowBox[{"costF", "/.", "rule\[Theta]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]deriv", " ", "=", " ", "\[Theta]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i", "<", 
    RowBox[{
     RowBox[{"Length", "[", "\[Theta]flat", "]"}], "+", "1"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"deriv", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"costF", ",", " ", 
        RowBox[{"\[Theta]flat", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", "rule\[Theta]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]deriv", " ", "=", " ", 
     RowBox[{"\[Theta]deriv", "/.", 
      RowBox[{
       RowBox[{"\[Theta]flat", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "->", "deriv"}]}]}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", " ", "=", "1"}], ",", " ", 
   RowBox[{"i", "<", 
    RowBox[{
     RowBox[{"Length", "[", "\[Theta]deriv", "]"}], "+", "1"}]}], ",", " ", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"\[Theta]deriv", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6663483710484886`*^9, 3.6663485243172555`*^9}, {
  3.666348623047044*^9, 3.666348693696515*^9}, {3.6663490570469446`*^9, 
  3.6663490595179405`*^9}, {3.666668308331461*^9, 3.666668336795903*^9}, {
  3.666668366828975*^9, 3.6666684462609043`*^9}, {3.6666684780296745`*^9, 
  3.6666684815180764`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Architecture: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}],
  SequenceForm["Architecture: ", {2, 2, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.666348502948645*^9, 3.6663485252006116`*^9}, {
   3.6663486683192883`*^9, 3.6663486942187266`*^9}, 3.6663490603372717`*^9, 
   3.6663520558504686`*^9, 3.6664377637730837`*^9, 3.6664381036043386`*^9, 
   3.6664398264561014`*^9, 3.6664399769484396`*^9, 3.6664401546286783`*^9, 
   3.6665854275594473`*^9, 3.666585808225333*^9, 3.66661201763347*^9, 
   3.666612285789169*^9, {3.6666125474473643`*^9, 3.666612565851651*^9}, 
   3.666613050271207*^9, 3.666613921653177*^9, 3.6666143184735518`*^9, 
   3.6666681027058053`*^9, {3.6666683398611345`*^9, 3.666668368296565*^9}, {
   3.666668437406345*^9, 3.6666684469491816`*^9}, 3.666668482877623*^9, 
   3.6666716388962493`*^9, 3.666671697150666*^9, 3.666671778373315*^9, 
   3.66697766552812*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"J=\"\>", "\[InvisibleSpace]", 
   "1.46142454991038145729121490305333106016`5.799884768312856"}],
  SequenceForm[
  "J=", 1.46142454991038145729121490305333106016`5.799884768312856],
  Editable->False]], "Print",
 CellChangeTimes->{{3.666348502948645*^9, 3.6663485252006116`*^9}, {
   3.6663486683192883`*^9, 3.6663486942187266`*^9}, 3.6663490603372717`*^9, 
   3.6663520558504686`*^9, 3.6664377637730837`*^9, 3.6664381036043386`*^9, 
   3.6664398264561014`*^9, 3.6664399769484396`*^9, 3.6664401546286783`*^9, 
   3.6665854275594473`*^9, 3.666585808225333*^9, 3.66661201763347*^9, 
   3.666612285789169*^9, {3.6666125474473643`*^9, 3.666612565851651*^9}, 
   3.666613050271207*^9, 3.666613921653177*^9, 3.6666143184735518`*^9, 
   3.6666681027058053`*^9, {3.6666683398611345`*^9, 3.666668368296565*^9}, {
   3.666668437406345*^9, 3.6666684469491816`*^9}, 3.666668482877623*^9, 
   3.6666716388962493`*^9, 3.666671697150666*^9, 3.666671778373315*^9, 
   3.66697766553312*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.10671769394487125761027627137840224281`4.786757461990992", 
      RowBox[{
      "-", "0.10458206889520891893386955680061476134`4.529020433352084"}], 
      "0.06964728226459891011779937534426367395`4.712674594089916"},
     {"0.01648370671802465044567536223524830042`4.708671508771041", 
      RowBox[{
      "-", "0.01540902143943175464711760352623584397`4.463936585513921"}], 
      "0.01055006555863345179243885744019273336`4.707127190369334"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.666348502948645*^9, 3.6663485252006116`*^9}, {
   3.6663486683192883`*^9, 3.6663486942187266`*^9}, 3.6663490603372717`*^9, 
   3.6663520558504686`*^9, 3.6664377637730837`*^9, 3.6664381036043386`*^9, 
   3.6664398264561014`*^9, 3.6664399769484396`*^9, 3.6664401546286783`*^9, 
   3.6665854275594473`*^9, 3.666585808225333*^9, 3.66661201763347*^9, 
   3.666612285789169*^9, {3.6666125474473643`*^9, 3.666612565851651*^9}, 
   3.666613050271207*^9, 3.666613921653177*^9, 3.6666143184735518`*^9, 
   3.6666681027058053`*^9, {3.6666683398611345`*^9, 3.666668368296565*^9}, {
   3.666668437406345*^9, 3.6666684469491816`*^9}, 3.666668482877623*^9, 
   3.6666716388962493`*^9, 3.666671697150666*^9, 3.666671778373315*^9, 
   3.666977665633126*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.55946798678999961456527348170402611266`5.066848316689948", 
      "0.32107190336864363466062652217105718529`4.9928398338398265", 
      "0.24273457412231454934759009192708584258`5.045484233987945"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.666348502948645*^9, 3.6663485252006116`*^9}, {
   3.6663486683192883`*^9, 3.6663486942187266`*^9}, 3.6663490603372717`*^9, 
   3.6663520558504686`*^9, 3.6664377637730837`*^9, 3.6664381036043386`*^9, 
   3.6664398264561014`*^9, 3.6664399769484396`*^9, 3.6664401546286783`*^9, 
   3.6665854275594473`*^9, 3.666585808225333*^9, 3.66661201763347*^9, 
   3.666612285789169*^9, {3.6666125474473643`*^9, 3.666612565851651*^9}, 
   3.666613050271207*^9, 3.666613921653177*^9, 3.6666143184735518`*^9, 
   3.6666681027058053`*^9, {3.6666683398611345`*^9, 3.666668368296565*^9}, {
   3.666668437406345*^9, 3.6666684469491816`*^9}, 3.666668482877623*^9, 
   3.6666716388962493`*^9, 3.666671697150666*^9, 3.666671778373315*^9, 
   3.6669776656641273`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindMinimum", "[", 
  RowBox[{"costF", ",", " ", "\[Theta]flat"}], "]"}]], "Input",
 CellChangeTimes->{{3.66635449426364*^9, 3.6663545047578683`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.0339255060559083`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]110", "\[Rule]", "2.963832995128388`*^-6"}], ",", 
     RowBox[{"\[Theta]111", "\[Rule]", "1.9754293636693374`*^-6"}], ",", 
     RowBox[{"\[Theta]112", "\[Rule]", "2.9638849935537683`*^-6"}], ",", 
     RowBox[{"\[Theta]120", "\[Rule]", "2.963832995128388`*^-6"}], ",", 
     RowBox[{"\[Theta]121", "\[Rule]", "1.9754293636693374`*^-6"}], ",", 
     RowBox[{"\[Theta]122", "\[Rule]", "2.9638849935537683`*^-6"}], ",", 
     RowBox[{"\[Theta]130", "\[Rule]", "2.9638329951283876`*^-6"}], ",", 
     RowBox[{"\[Theta]131", "\[Rule]", "1.9754293636693374`*^-6"}], ",", 
     RowBox[{"\[Theta]132", "\[Rule]", "2.9638849935537683`*^-6"}], ",", 
     RowBox[{"\[Theta]140", "\[Rule]", "2.963832995128388`*^-6"}], ",", 
     RowBox[{"\[Theta]141", "\[Rule]", "1.9754293636693374`*^-6"}], ",", 
     RowBox[{"\[Theta]142", "\[Rule]", "2.9638849935537683`*^-6"}], ",", 
     RowBox[{"\[Theta]150", "\[Rule]", "2.963832995128388`*^-6"}], ",", 
     RowBox[{"\[Theta]151", "\[Rule]", "1.9754293636693374`*^-6"}], ",", 
     RowBox[{"\[Theta]152", "\[Rule]", "2.9638849935537687`*^-6"}], ",", 
     RowBox[{"\[Theta]210", "\[Rule]", "0.001987985533919169`"}], ",", 
     RowBox[{"\[Theta]211", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]212", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]213", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]214", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]215", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]220", "\[Rule]", "0.001987985533919169`"}], ",", 
     RowBox[{"\[Theta]221", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]222", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]223", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]224", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]225", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]230", "\[Rule]", "0.001987985533919169`"}], ",", 
     RowBox[{"\[Theta]231", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]232", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]233", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]234", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]235", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]240", "\[Rule]", "0.001987985533919169`"}], ",", 
     RowBox[{"\[Theta]241", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]242", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]243", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]244", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]245", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]250", "\[Rule]", "0.001987985533919169`"}], ",", 
     RowBox[{"\[Theta]251", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]252", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]253", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]254", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]255", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]260", "\[Rule]", "0.001987985533919169`"}], ",", 
     RowBox[{"\[Theta]261", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]262", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]263", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]264", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]265", "\[Rule]", "0.0009939961303042084`"}], ",", 
     RowBox[{"\[Theta]310", "\[Rule]", 
      RowBox[{"-", "0.07272888198851601`"}]}], ",", 
     RowBox[{"\[Theta]311", "\[Rule]", 
      RowBox[{"-", "0.03644576931683367`"}]}], ",", 
     RowBox[{"\[Theta]312", "\[Rule]", 
      RowBox[{"-", "0.03644576931683367`"}]}], ",", 
     RowBox[{"\[Theta]313", "\[Rule]", 
      RowBox[{"-", "0.03644576931683367`"}]}], ",", 
     RowBox[{"\[Theta]314", "\[Rule]", 
      RowBox[{"-", "0.03644576931683367`"}]}], ",", 
     RowBox[{"\[Theta]315", "\[Rule]", 
      RowBox[{"-", "0.03644576931683367`"}]}], ",", 
     RowBox[{"\[Theta]316", "\[Rule]", 
      RowBox[{"-", "0.03644576931683367`"}]}], ",", 
     RowBox[{"\[Theta]320", "\[Rule]", 
      RowBox[{"-", "0.07272888291282156`"}]}], ",", 
     RowBox[{"\[Theta]321", "\[Rule]", 
      RowBox[{"-", "0.03644577030750876`"}]}], ",", 
     RowBox[{"\[Theta]322", "\[Rule]", 
      RowBox[{"-", "0.03644577030750876`"}]}], ",", 
     RowBox[{"\[Theta]323", "\[Rule]", 
      RowBox[{"-", "0.03644577030750876`"}]}], ",", 
     RowBox[{"\[Theta]324", "\[Rule]", 
      RowBox[{"-", "0.03644577030750876`"}]}], ",", 
     RowBox[{"\[Theta]325", "\[Rule]", 
      RowBox[{"-", "0.03644577030750876`"}]}], ",", 
     RowBox[{"\[Theta]326", "\[Rule]", 
      RowBox[{"-", "0.03644577030750876`"}]}], ",", 
     RowBox[{"\[Theta]330", "\[Rule]", 
      RowBox[{"-", "0.07272888440363533`"}]}], ",", 
     RowBox[{"\[Theta]331", "\[Rule]", 
      RowBox[{"-", "0.03644577129419129`"}]}], ",", 
     RowBox[{"\[Theta]332", "\[Rule]", 
      RowBox[{"-", "0.03644577129419129`"}]}], ",", 
     RowBox[{"\[Theta]333", "\[Rule]", 
      RowBox[{"-", "0.03644577129419129`"}]}], ",", 
     RowBox[{"\[Theta]334", "\[Rule]", 
      RowBox[{"-", "0.03644577129419129`"}]}], ",", 
     RowBox[{"\[Theta]335", "\[Rule]", 
      RowBox[{"-", "0.03644577129419129`"}]}], ",", 
     RowBox[{"\[Theta]336", "\[Rule]", 
      RowBox[{"-", "0.03644577129419129`"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6663545050289783`*^9, 3.666354706121019*^9, 
  3.666437848697134*^9, 3.666671803953597*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1108, 431},
WindowMargins->{{-10, Automatic}, {Automatic, 15}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 215, 4, 137, "Title"],
Cell[CellGroupData[{
Cell[819, 30, 154, 2, 71, "Section"],
Cell[CellGroupData[{
Cell[998, 36, 9057, 239, 399, "Input"],
Cell[10058, 277, 1280, 19, 30, "Output"],
Cell[11341, 298, 1520, 26, 30, "Output"],
Cell[CellGroupData[{
Cell[12886, 328, 2078, 41, 36, "Print"],
Cell[14967, 371, 1942, 39, 23, "Print"]
}, Open  ]],
Cell[16924, 413, 2271, 48, 30, "Output"]
}, Open  ]],
Cell[19210, 464, 1620, 35, 72, "Input"],
Cell[CellGroupData[{
Cell[20855, 503, 2003, 50, 92, "Input"],
Cell[22861, 555, 1854, 39, 30, "Output"],
Cell[24718, 596, 1854, 39, 30, "Output"]
}, Open  ]],
Cell[26587, 638, 301, 9, 47, "Input"],
Cell[CellGroupData[{
Cell[26913, 651, 4493, 101, 112, "Input"],
Cell[31409, 754, 3112, 73, 84, "Output"],
Cell[34524, 829, 2889, 57, 69, "Output"]
}, Open  ]],
Cell[37428, 889, 2803, 69, 107, "Input"],
Cell[CellGroupData[{
Cell[40256, 962, 902, 16, 31, "Input"],
Cell[41161, 980, 4455, 99, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45653, 1084, 103, 1, 36, "Subsection"],
Cell[45759, 1087, 625, 14, 52, "Input"],
Cell[CellGroupData[{
Cell[46409, 1105, 1954, 49, 252, "Input"],
Cell[CellGroupData[{
Cell[48388, 1158, 993, 17, 23, "Print"],
Cell[49384, 1177, 1023, 17, 23, "Print"],
Cell[50410, 1196, 1771, 34, 36, "Print"],
Cell[52184, 1232, 1523, 29, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53756, 1267, 174, 3, 31, "Input"],
Cell[53933, 1272, 5914, 99, 225, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
