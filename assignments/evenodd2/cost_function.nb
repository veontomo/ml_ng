(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     25251,        698]
NotebookOptionsPosition[     23919,        647]
NotebookOutlinePosition[     24263,        662]
CellTagsIndexPosition[     24220,        659]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Calculate the cost function of a neural network with given architecture\
\>", "Title",
 CellChangeTimes->{{3.6662905917646275`*^9, 3.666290647241801*^9}, {
  3.666291453248902*^9, 3.6662914584932017`*^9}}],

Cell[CellGroupData[{

Cell["The network description", "Section",
 CellChangeTimes->{{3.666290719831953*^9, 3.6662907347568064`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"archit", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"5", ",", " ", "3", ",", " ", "2"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6662840534046545`*^9, 3.666284102570467*^9}, {
  3.666284510998828*^9, 3.666284513916995*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "3", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.6662841046755877`*^9, 3.666284514432024*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<\[Theta]\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "<>", 
         RowBox[{"ToString", "[", "j", "]"}], "<>", 
         RowBox[{"ToString", "[", "k", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", " ", 
         RowBox[{"archit", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"k", ",", " ", "0", ",", " ", 
         RowBox[{"archit", "[", 
          RowBox[{"[", 
           RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", " ", 
       RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.666284109387857*^9, 3.6662841372464504`*^9}, {
   3.666284177399747*^9, 3.6662843513486967`*^9}, {3.666288289683956*^9, 
   3.6662883007135873`*^9}, 3.6662907509087305`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "<", 
    RowBox[{"Length", "[", "archit", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"Superscript", "[", 
      RowBox[{"\"\<\[Theta]\>\"", ",", " ", "i"}], "]"}], ",", "\"\< = \>\"", 
     ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"\[Theta]", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6662907740820556`*^9, 3.6662908858004456`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TemplateBox[{"\"\[Theta]\"","1"},
    "Superscript"], "\[InvisibleSpace]", "\<\" = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"\[Theta]110", "\[Theta]111", "\[Theta]112", "\[Theta]113", 
        "\[Theta]114", "\[Theta]115"},
       {"\[Theta]120", "\[Theta]121", "\[Theta]122", "\[Theta]123", 
        "\[Theta]124", "\[Theta]125"},
       {"\[Theta]130", "\[Theta]131", "\[Theta]132", "\[Theta]133", 
        "\[Theta]134", "\[Theta]135"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
   Superscript["\[Theta]", 1], " = ", 
   MatrixForm[{{$CellContext`\[Theta]110, $CellContext`\[Theta]111, \
$CellContext`\[Theta]112, $CellContext`\[Theta]113, $CellContext`\[Theta]114, \
$CellContext`\[Theta]115}, {$CellContext`\[Theta]120, \
$CellContext`\[Theta]121, $CellContext`\[Theta]122, $CellContext`\[Theta]123, \
$CellContext`\[Theta]124, $CellContext`\[Theta]125}, \
{$CellContext`\[Theta]130, $CellContext`\[Theta]131, \
$CellContext`\[Theta]132, $CellContext`\[Theta]133, $CellContext`\[Theta]134, \
$CellContext`\[Theta]135}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.666290832261383*^9, 3.6662908871085205`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TemplateBox[{"\"\[Theta]\"","2"},
    "Superscript"], "\[InvisibleSpace]", "\<\" = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"\[Theta]210", "\[Theta]211", "\[Theta]212", "\[Theta]213"},
       {"\[Theta]220", "\[Theta]221", "\[Theta]222", "\[Theta]223"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
   Superscript["\[Theta]", 2], " = ", 
   MatrixForm[{{$CellContext`\[Theta]210, $CellContext`\[Theta]211, \
$CellContext`\[Theta]212, $CellContext`\[Theta]213}, \
{$CellContext`\[Theta]220, $CellContext`\[Theta]221, \
$CellContext`\[Theta]222, $CellContext`\[Theta]223}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.666290832261383*^9, 3.6662908871245213`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"A", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<a\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", 
          RowBox[{"archit", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Z", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<z\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "1", ",", " ", 
        RowBox[{"archit", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6662909105658617`*^9, 3.666291055416147*^9}, {
  3.666291150679596*^9, 3.666291150997614*^9}, {3.666291866424534*^9, 
  3.666291866507539*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "a11", ",", "a12", ",", "a13", ",", "a14", ",", "a15"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "a21", ",", "a22", ",", "a23"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "a31", ",", "a32"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.666291007485406*^9, 3.666291020185132*^9}, 
   3.666291056074185*^9, 3.666291151783659*^9, 3.6662918670105677`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"z11", ",", "z12", ",", "z13", ",", "z14", ",", "z15"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"z21", ",", "z22", ",", "z23"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z31", ",", "z32"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.666291007485406*^9, 3.666291020185132*^9}, 
   3.666291056074185*^9, 3.666291151783659*^9, 3.666291867015568*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"h", "[", "x_", "]"}], "=", 
  FractionBox["1", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "x"}]]}]]}]], "Input",
 CellChangeTimes->{{3.666284545988829*^9, 3.6662845862261305`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]", "[", 
   RowBox[{"[", "1", "]"}], "]"}], ".", 
  RowBox[{"A", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6662915473612847`*^9, 3.6662915551377296`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Theta]110", "+", 
    RowBox[{"a11", " ", "\[Theta]111"}], "+", 
    RowBox[{"a12", " ", "\[Theta]112"}], "+", 
    RowBox[{"a13", " ", "\[Theta]113"}], "+", 
    RowBox[{"a14", " ", "\[Theta]114"}], "+", 
    RowBox[{"a15", " ", "\[Theta]115"}]}], ",", 
   RowBox[{"\[Theta]120", "+", 
    RowBox[{"a11", " ", "\[Theta]121"}], "+", 
    RowBox[{"a12", " ", "\[Theta]122"}], "+", 
    RowBox[{"a13", " ", "\[Theta]123"}], "+", 
    RowBox[{"a14", " ", "\[Theta]124"}], "+", 
    RowBox[{"a15", " ", "\[Theta]125"}]}], ",", 
   RowBox[{"\[Theta]130", "+", 
    RowBox[{"a11", " ", "\[Theta]131"}], "+", 
    RowBox[{"a12", " ", "\[Theta]132"}], "+", 
    RowBox[{"a13", " ", "\[Theta]133"}], "+", 
    RowBox[{"a14", " ", "\[Theta]134"}], "+", 
    RowBox[{"a15", " ", "\[Theta]135"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.666291555582755*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ruleA", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<a\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "1"}], ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<x\>\"", "<>", 
            RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
          RowBox[{"h", "[", 
           RowBox[{
            RowBox[{"Z", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", 
         RowBox[{"archit", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", " ", 
       RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ruleZ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<z\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], ".", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", 
         RowBox[{"archit", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", " ", 
       RowBox[{"Length", "[", "archit", "]"}]}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ruleH", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"\"\<h\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "\[Rule]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"\"\<a\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Length", "[", "archit", "]"}], "]"}], "<>", 
       RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", 
      RowBox[{"archit", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.666285763870488*^9, 3.6662857838046284`*^9}, {
   3.6662863647198544`*^9, 3.66628641481472*^9}, {3.666286450172742*^9, 
   3.6662865872455826`*^9}, {3.666286629093976*^9, 3.6662866320011425`*^9}, 
   3.666286684564149*^9, {3.666286722315308*^9, 3.666286878005213*^9}, {
   3.6662869129682126`*^9, 3.666286970039477*^9}, {3.666287005387499*^9, 
   3.6662870955966587`*^9}, {3.666287137726068*^9, 3.6662871825716333`*^9}, {
   3.6662872220408907`*^9, 3.6662872383328223`*^9}, {3.6662874587524295`*^9, 
   3.666287700128236*^9}, {3.6662877732274165`*^9, 3.6662877797647905`*^9}, {
   3.6662878367290487`*^9, 3.6662878518549137`*^9}, {3.6662881033723*^9, 
   3.6662881590974874`*^9}, {3.666290171884612*^9, 3.6662903249963694`*^9}, {
   3.666291186619652*^9, 3.6662911993133774`*^9}, {3.6662916174822955`*^9, 
   3.6662916730584745`*^9}, 3.666292034966174*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a11", "\[Rule]", "x1"}], ",", 
   RowBox[{"a12", "\[Rule]", "x2"}], ",", 
   RowBox[{"a13", "\[Rule]", "x3"}], ",", 
   RowBox[{"a14", "\[Rule]", "x4"}], ",", 
   RowBox[{"a15", "\[Rule]", "x5"}], ",", 
   RowBox[{"a21", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z21"}]]}]]}], ",", 
   RowBox[{"a22", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z22"}]]}]]}], ",", 
   RowBox[{"a23", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z23"}]]}]]}], ",", 
   RowBox[{"a31", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z31"}]]}]]}], ",", 
   RowBox[{"a32", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "z32"}]]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.666291673985527*^9, 3.666291870054742*^9, 
  3.66629203611524*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"z21", "\[Rule]", 
    RowBox[{"\[Theta]110", "+", 
     RowBox[{"a11", " ", "\[Theta]111"}], "+", 
     RowBox[{"a12", " ", "\[Theta]112"}], "+", 
     RowBox[{"a13", " ", "\[Theta]113"}], "+", 
     RowBox[{"a14", " ", "\[Theta]114"}], "+", 
     RowBox[{"a15", " ", "\[Theta]115"}]}]}], ",", 
   RowBox[{"z22", "\[Rule]", 
    RowBox[{"\[Theta]120", "+", 
     RowBox[{"a11", " ", "\[Theta]121"}], "+", 
     RowBox[{"a12", " ", "\[Theta]122"}], "+", 
     RowBox[{"a13", " ", "\[Theta]123"}], "+", 
     RowBox[{"a14", " ", "\[Theta]124"}], "+", 
     RowBox[{"a15", " ", "\[Theta]125"}]}]}], ",", 
   RowBox[{"z23", "\[Rule]", 
    RowBox[{"\[Theta]130", "+", 
     RowBox[{"a11", " ", "\[Theta]131"}], "+", 
     RowBox[{"a12", " ", "\[Theta]132"}], "+", 
     RowBox[{"a13", " ", "\[Theta]133"}], "+", 
     RowBox[{"a14", " ", "\[Theta]134"}], "+", 
     RowBox[{"a15", " ", "\[Theta]135"}]}]}], ",", 
   RowBox[{"z31", "\[Rule]", 
    RowBox[{"\[Theta]210", "+", 
     RowBox[{"a21", " ", "\[Theta]211"}], "+", 
     RowBox[{"a22", " ", "\[Theta]212"}], "+", 
     RowBox[{"a23", " ", "\[Theta]213"}]}]}], ",", 
   RowBox[{"z32", "\[Rule]", 
    RowBox[{"\[Theta]220", "+", 
     RowBox[{"a21", " ", "\[Theta]221"}], "+", 
     RowBox[{"a22", " ", "\[Theta]222"}], "+", 
     RowBox[{"a23", " ", "\[Theta]223"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.666291673985527*^9, 3.666291870054742*^9, 
  3.66629203612224*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"h1", "\[Rule]", "a31"}], ",", 
   RowBox[{"h2", "\[Rule]", "a32"}]}], "}"}]], "Output",
 CellChangeTimes->{3.666291673985527*^9, 3.666291870054742*^9, 
  3.6662920361262407`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"J", " ", "[", " ", 
   RowBox[{"Y_", ",", " ", "\[Theta]_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{"[", "a", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], 
        RowBox[{"Log", "[", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<h\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"Y", "[", 
            RowBox[{"[", "a", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<h\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"Y", "[", 
          RowBox[{"[", "a", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", " ", "1", ",", " ", 
      RowBox[{"Length", "[", "Y", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6662846018580246`*^9, 3.6662846160098343`*^9}, {
   3.6662846464095726`*^9, 3.666284671989036*^9}, {3.6662847109462643`*^9, 
   3.666284750665536*^9}, 3.666285190010665*^9, {3.6662852344242053`*^9, 
   3.6662852981698513`*^9}, {3.6662853442594876`*^9, 
   3.6662854565759115`*^9}, {3.666285527825987*^9, 3.6662855512033243`*^9}, {
   3.6662884796128197`*^9, 3.6662885504698725`*^9}, {3.6662900999264965`*^9, 
   3.6662901254439554`*^9}, {3.6662904702506776`*^9, 3.666290477553095*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "\[Theta]"}], "]"}], "/.",
    "H"}], "//.", 
  RowBox[{"Join", "[", 
   RowBox[{"A", ",", "Z"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6662885551451397`*^9, 3.666288593838353*^9}, {
   3.666290129785204*^9, 3.6662901299552135`*^9}, {3.6662903709779997`*^9, 
   3.6662903738451633`*^9}, {3.666290407141068*^9, 3.666290438858882*^9}, 
   3.6662904922119336`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Log", "[", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Theta]210"}], "-", 
        FractionBox["\[Theta]211", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]110"}], "-", 
            RowBox[{"x1", " ", "\[Theta]111"}], "-", 
            RowBox[{"x2", " ", "\[Theta]112"}], "-", 
            RowBox[{"x3", " ", "\[Theta]113"}], "-", 
            RowBox[{"x4", " ", "\[Theta]114"}], "-", 
            RowBox[{"x5", " ", "\[Theta]115"}]}]]}]], "-", 
        FractionBox["\[Theta]212", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]120"}], "-", 
            RowBox[{"x1", " ", "\[Theta]121"}], "-", 
            RowBox[{"x2", " ", "\[Theta]122"}], "-", 
            RowBox[{"x3", " ", "\[Theta]123"}], "-", 
            RowBox[{"x4", " ", "\[Theta]124"}], "-", 
            RowBox[{"x5", " ", "\[Theta]125"}]}]]}]], "-", 
        FractionBox["\[Theta]213", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]130"}], "-", 
            RowBox[{"x1", " ", "\[Theta]131"}], "-", 
            RowBox[{"x2", " ", "\[Theta]132"}], "-", 
            RowBox[{"x3", " ", "\[Theta]133"}], "-", 
            RowBox[{"x4", " ", "\[Theta]134"}], "-", 
            RowBox[{"x5", " ", "\[Theta]135"}]}]]}]]}]]}]], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"Log", "[", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Theta]220"}], "-", 
        FractionBox["\[Theta]221", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]110"}], "-", 
            RowBox[{"x1", " ", "\[Theta]111"}], "-", 
            RowBox[{"x2", " ", "\[Theta]112"}], "-", 
            RowBox[{"x3", " ", "\[Theta]113"}], "-", 
            RowBox[{"x4", " ", "\[Theta]114"}], "-", 
            RowBox[{"x5", " ", "\[Theta]115"}]}]]}]], "-", 
        FractionBox["\[Theta]222", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]120"}], "-", 
            RowBox[{"x1", " ", "\[Theta]121"}], "-", 
            RowBox[{"x2", " ", "\[Theta]122"}], "-", 
            RowBox[{"x3", " ", "\[Theta]123"}], "-", 
            RowBox[{"x4", " ", "\[Theta]124"}], "-", 
            RowBox[{"x5", " ", "\[Theta]125"}]}]]}]], "-", 
        FractionBox["\[Theta]223", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]130"}], "-", 
            RowBox[{"x1", " ", "\[Theta]131"}], "-", 
            RowBox[{"x2", " ", "\[Theta]132"}], "-", 
            RowBox[{"x3", " ", "\[Theta]133"}], "-", 
            RowBox[{"x4", " ", "\[Theta]134"}], "-", 
            RowBox[{"x5", " ", "\[Theta]135"}]}]]}]]}]]}]], "]"}]}], "-", 
  RowBox[{"Log", "[", 
   RowBox[{"1", "-", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Theta]210"}], "-", 
        FractionBox["\[Theta]211", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]110"}], "-", 
            RowBox[{"x1", " ", "\[Theta]111"}], "-", 
            RowBox[{"x2", " ", "\[Theta]112"}], "-", 
            RowBox[{"x3", " ", "\[Theta]113"}], "-", 
            RowBox[{"x4", " ", "\[Theta]114"}], "-", 
            RowBox[{"x5", " ", "\[Theta]115"}]}]]}]], "-", 
        FractionBox["\[Theta]212", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]120"}], "-", 
            RowBox[{"x1", " ", "\[Theta]121"}], "-", 
            RowBox[{"x2", " ", "\[Theta]122"}], "-", 
            RowBox[{"x3", " ", "\[Theta]123"}], "-", 
            RowBox[{"x4", " ", "\[Theta]124"}], "-", 
            RowBox[{"x5", " ", "\[Theta]125"}]}]]}]], "-", 
        FractionBox["\[Theta]213", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[Theta]130"}], "-", 
            RowBox[{"x1", " ", "\[Theta]131"}], "-", 
            RowBox[{"x2", " ", "\[Theta]132"}], "-", 
            RowBox[{"x3", " ", "\[Theta]133"}], "-", 
            RowBox[{"x4", " ", "\[Theta]134"}], "-", 
            RowBox[{"x5", " ", "\[Theta]135"}]}]]}]]}]]}]]}], 
   "]"}]}]], "Output",
 CellChangeTimes->{{3.6662885845418215`*^9, 3.666288594395385*^9}, {
   3.6662901083659787`*^9, 3.66629013041224*^9}, 3.6662903744481983`*^9, {
   3.6662904080061173`*^9, 3.6662904397919354`*^9}, {3.666290479312196*^9, 
   3.6662904928159685`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1101, 537},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 215, 4, 137, "Title"],
Cell[CellGroupData[{
Cell[819, 30, 110, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[954, 35, 248, 5, 31, "Input"],
Cell[1205, 42, 149, 3, 30, "Output"]
}, Open  ]],
Cell[1369, 48, 1130, 28, 52, "Input"],
Cell[CellGroupData[{
Cell[2524, 80, 561, 15, 31, "Input"],
Cell[CellGroupData[{
Cell[3110, 99, 1701, 37, 50, "Print"],
Cell[4814, 138, 1245, 29, 36, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6108, 173, 1459, 39, 52, "Input"],
Cell[7570, 214, 463, 11, 30, "Output"],
Cell[8036, 227, 430, 11, 30, "Output"]
}, Open  ]],
Cell[8481, 241, 252, 7, 47, "Input"],
Cell[CellGroupData[{
Cell[8758, 252, 230, 6, 31, "Input"],
Cell[8991, 260, 902, 21, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9930, 286, 3624, 87, 132, "Input"],
Cell[13557, 375, 1146, 34, 47, "Output"],
Cell[14706, 411, 1484, 35, 50, "Output"],
Cell[16193, 448, 230, 6, 30, "Output"]
}, Open  ]],
Cell[16438, 457, 1827, 45, 52, "Input"],
Cell[CellGroupData[{
Cell[18290, 506, 610, 17, 31, "Input"],
Cell[18903, 525, 4976, 117, 166, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
